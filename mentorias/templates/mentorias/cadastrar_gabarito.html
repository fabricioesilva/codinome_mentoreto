{% extends 'base.html' %}
{% load i18n %}
{% load static %}
{% block content %}
<section class="home-wrap">
    <div class="home-lateral">
        <div class="menu-lateral-bar">
            <h4>Menu</h4>
            <ul class="home-list">
                <li><a href="{% url 'usuarios:home_student' %}">Ferramenta do
                        Estudante</a></li>
                <li><h4>Ferramenta do Mentor</h4></li>
            </ul>
        </div>
    </div>
    <div class="home-principal">
        <div class="home-panel-flex">
            <p><a href="{% url 'mentorias:mentorias_home' %}">Mentorias</a></p>
            <p>|</p>
            <p><a href="{% url 'mentorias:alunos' %}">Alunos</a></p>
            <p>|</p>
            <p><a href="{% url 'mentorias:simulados' %}"><b>Simulados</b></a></p>
            <p>|</p>
            <p><a href="{% url 'mentorias:arquivos' %}">Arquivos</a></p>
            <p>|</p>          
            <p><a href="{% url 'mentorias:materias' %}">Materias</a></p>                                                 
        </div>
        <div class="home-panel-flex">
            <p>Gabarito / <b>Criar gabarito</b></p>
        </div>
        <div class="home-content-flex">
            {% if materias %}
                <h3>Entre com os dados do gabarito</h3>
                <form action class="basic-form" method="POST" id="gabaritoShapeForm">
                    {% csrf_token %}
                    <table>
                        <thead>
                            <tr>
                                <th>Matéria</th>
                                <th>Quantidade de questões</th>
                                <th>Respostas</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for materia in materias %}
                            <tr>
                                <td>
                                    <select name="itemSelect" id="select-{{ forloop.counter0 }}">
                                        {% for materia in materias %}
                                        <option value="{{materia}}">{{ materia.titulo }}</option>
                                        {% endfor %}
                                    </select>
                                </td>
                                <td>
                                    <input type="number" name="qtdInput-{{loop.counter0}}" id="qtdInput-{{ forloop.counter0 }}">
                                </td>
                                <td>
                                    <input type="text" style="text-transform:uppercase" name="respostasInput-{{ loop.counter0 }}" id="respostasInput-{{ loop.counter0 }}">
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <button type="submit">Criar</button>
                </form>
            {% else %}                            
            <p>Antes de montar o gabarito vá em Menu/Matérias e crie as matérias do simulado.</p>
            {% endif %}
        </div>
        <div class="home-content-flex div-margin-top">
            <div>
                <table>
                    <thead>
                        <tr>
                            <th>Número da questão</th>
                            <th>Matéria</th>                            
                        </tr>
                    </thead>
                    <tbody id="gabaritoTbody">

                    </tbody>
                </table>
            </div>
        </div>        
    </div>
    <div class="home-direita"></div>
<div id="conteudoModal" class="modal-conteudo">
    <form class="modal-conteudo-form" action>
        <div class="modal-conteudo-container">
            <h1 id="modalAlerta"></h1>
            <p id="modalText"></p>
            <div class="clearfix">
                <p id="modal-try-later" class="error-try-later">Um erro
                    aconteceu. Tente novamente mais tarde.</p>
                <button type="button" class="cancelBtn">Cancelar</button>
                <button type="button" id="confirmBtn">Confirmar</button>
            </div>
        </div>
    </form>
</div>
<script>
    const form = document.querySelector('form');
    let gabaritoDemonstrado = document.getElementById('gabaritoTbody');
    let gabaritoTbody = document.getElementById('gabaritoTbody');
    
    form.addEventListener('change', function() {        
        gabaritoTbody.innerHTML = '';        
        contador = 1;
        for(let i=0; i < '{{materias.count }}'; i++){
            console.log('foiiiii');
            let selectMateria = document.getElementById('select-'+i);
            let qtdInput = document.getElementById('qtdInput-'+ i);            
            for(let k=1; k<= qtdInput.value; k++) {
                let newTr = document.createElement('tr');
                let tdQtdNum = document.createElement('td')
                tdQtdNum.innerHTML = 'Questão ' + contador+":";
                contador++
                newTr.appendChild(tdQtdNum);
                let tdMateria = document.createElement('td');
                tdMateria.innerHTML = selectMateria.value;
                newTr.appendChild(tdMateria);
                gabaritoTbody.appendChild(newTr);
            }
        }
});
</script>
</section>
{% endblock %}
